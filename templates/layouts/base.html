<!doctype html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="google" content="notranslate" />
    <meta http-equiv="Content-Language" content="en_US" />
    <meta name="author" content="{{ config.author }}">
    <meta name="description" content="{% block description %}{{ config.description }}{% endblock description %}">
    <title>{% block title %}{{ config.title }}{% endblock title %}</title>
    <link rel="stylesheet" href="{{ get_url(path='fonts/IosevkaWeb/IosevkaWeb.css') }}" />
    <link rel="stylesheet" href="{{ get_url(path='style/normalize.css') }}" />
    <link rel="stylesheet" href="{{ get_url(path='style/index.min.css') }}" />
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/gsap.min.js"></script>
    <script src="https://unpkg.com/@barba/core"></script>
  </head>
  <body data-barba="wrapper">
      <div data-barba="container" data-barba-namespace="main">
      {% block content %}{% endblock content %}
      </div>
      {% include "widgets/bottombar.html" %}
      <!-- <section class="sidebar"> -->
      <!--   {% block sidebar %}{% endblock sidebar %} -->
      <!-- </section> -->
    <!-- <footer class="container"> -->
    <!--     {% include "widgets/footer.html" %} -->
    <!-- </footer> -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      let currentPath = window.location.pathname;

      const links = document.querySelectorAll(".navbar a");

      links.forEach((link) => {
        const linkPath = new URL(link.href).pathname;
        if (linkPath === currentPath) {
          link.classList.add("active");
        } else {
          link.classList.remove("active");
        }
      });
    });
  </script>
  <script>
    const button = document.querySelector("[data-toggle-theme]");
    const storage = localStorage.getItem("theme");
    const system = window.matchMedia("(prefers-color-scheme: dark)");
    let current = storage !== null ? storage : system.matches  ? "dark" : "light";

    const setTheme = (theme) => {
      document.getElementById("light").style.display = theme === "dark" ? "inline" : "none";
      document.getElementById("dark").style.display = theme === "dark" ? "none" : "inline";
      document.documentElement.setAttribute("data-theme", theme);
      localStorage.setItem("theme", theme);
      current = theme;
      button.setAttribute("aria-label", theme === "dark" ? "Change to light theme" : "Change to dark theme");
    };

    button.addEventListener("click", () => {
      console.log("theme changed");
      setTheme(current === "dark" ? "light" : "dark")
    });

    document.addEventListener("DOMContentLoaded", setTheme(current));
  </script>
  <script>
    barba.init({
      transitions: [{
        name: 'opacity-transition',
        leave(data) {
          return gsap.to(data.current.container, {
            opacity: 0
          });
        },
        enter(data) {
          return gsap.from(data.next.container, {
            opacity: 0
          });
        }
      }]
    });
  </script>
  </body>
</html>
